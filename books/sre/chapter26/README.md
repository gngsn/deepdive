# CHAPTER 26. Data Integrity: What You Read Is What You Wrote
    
- **데이터 무결성**? 사용자가 충분히 만족할 수 있는 수준의 서비스를 제공하기 위한 데이터 저장소의 접근성과 정확성의 척도
  - 예를 들어, Gmail 사용자 인터페이스에서 너무 오랫동안 빈 메일함이 표시되면 사용자는 데이터가 손실되었다고 생각할 수 있음. 
    - 실제로 데이터가 손실되지 않았더라도, Google의 데이터 관리를 의심할 것이며, 클라우드 컴퓨팅의 신뢰성 저하.
- 데이터가 사용할 수 없게 되는 "너무 오래"의 기준은? Gmail 사고는 4일, 구글 앱스는 24시간.
- 데이터 손실이나 데이터 손상, 장기간의 데이터 사용 불가 상태는 사용자에게 거의 구별되지 않음.
- 사용자는 제품 사이에 명확한 구분을 두지 않음: 구글 제품인지 클라우드 기반인지의 구분 등.
  - → **데이터 무결성은 모든 서비스의 모든 유형의 데이터에 적용됨.**

## Data Integrity’s Strict Requirements

- 시스템 신뢰성 고려 시, 가동 시간(서비스 가용성)이 데이터 무결성보다 더 중요하게 보일 수 있음. 
  - 가령, 4일 동안 메일 복구되는 것보다 한 시간 동안 이메일이 다운되는 것은 더 예민함.
- 사용자는 각 서비스마다 가용성과 데이터 무결성의 요구사항을 가짐
- 데이터 손실을 피하는 가장 확실한 방법은 사전 검출과 신속한 수리.

### Choosing a Strategy for Superior Data Integrity

- 신속한 데이터 손실 감지, 수리 및 복구를 위한 여러 전략이 존재.
- 각 전략은 영향을 받는 사용자에 대한 **가동 시간**과 **데이터 무결성** 간 트레이드 오프 고려.
- 클라우드 컴퓨팅 애플리케이션의 최적화 노력을 위한 고려 사항: **uptime, latency, scale, velocity, privacy**. (업타임, 지연응답, 규모, 속도, 개인정보 보호)
  - ACID와 BASE API를 기반으로 위 다섯가지 요소를 고려한 데이터 무결성 전략을 선택.
  - BASE: Basically Available, Soft state, Eventually consistent (기본적으로 사용 가능한 상태, 유연한 상태, 최종적 일관성)
  - BASE는 데이터의 일부가 갱신되지 않을 때에만 그 값이 결과적으로 저장소의 모든 위치에 일관되게 저장하는 것을 의미.

### Backups Versus Archives
- 회사는 데이터 손실을 방지하기 위해 백업 전략에 투자.
- 진정한 목적은 백업과 구분되는 **데이터 '복구'**
- 백업과 보관의 차이점은 데이터 **복구 가능성**.
- 아카이브는 장기 보관을 위해 데이터를 안전하게 유지하지만, 복구는 서비스 가동 시간 요구 사항을 충족해야 함.

### Requirements of the Cloud Environment in Perspective

- 클라우드 환경에서는 사용자의 요구를 충족시키기 위해 복잡한 데이터 무결성 요구 사항을 충족해야 함.
- 데이터 무결성을 보장하는 것은 사용자가 데이터를 항상 접근할 수 있도록 하는 것.

<br/>

## Google SRE Objectives in Maintaining Data Integrity and Availability

### Data Integrity Is the Means; Data Availability Is the Goal

<small><i>데이터 무결성은 수단이며, 데이터 가용성은 목표</i></small>

- 데이터 무결성은 데이터의 정확성과 일관성을 의미
- 데이터의 정확성과 일관성을 보장하는 것만으로는 충분하지 않음
- **사용자가 데이터에 접근할 수 없으면 무결성이 보장되어도 의미가 없어짐**

<br/>

### Delivering a Recovery System, Rather Than a Backup System

<small><i>백업 시스템이 아닌 복구 시스템 제공</i></small>

- 데이터 백업은 간과되기 쉬운 작업
- 백업보다는 **복구 시스템에 집중하여 데이터를 보장하는 것이 더 중요**
- 다양한 실패에 따른 **1️⃣ 데이터 가용성 목표(SLO)를 정의**하고 이를 충족하도록 **2️⃣ 팀 단위로 연습하고 입증해야함**

<br/>

### Types of Failures That Lead to Data Loss

<small><i>데이터 유실을 초래하는 장애 유형</i></small>

- 데이터 무결성 실패 모드의 요소인 **근본 원인**, **범위**, **비율**을 고려하여 설계
  - **근본 원인**: 복구 불가능한 데이터의 유실은 사용자 행위, 운영자 실수, 버그, 인프라 결함 등으로 나타날 수 있음
  - **범위**: 장애에 따라  광범위하거나 한정적인 영향을 끼침
  - **비율**: 장애에 따라 영향력이 매우 크거나 매우 작을 수 있음
- 여러 가지 오류 조합을 고려한 효과적인 복구 계획 필요
- Google의 연구에 따르면 데이터 손실은 주로 소프트웨어 버그로 인한 데이터 삭제 또는 참조 무결성 손실
- Point-in-time recovery: 시점 기반 복구. (time-travel in Google). 데이터 유실에 영향을 받은 산출물들을 특정 시점으로 복구할 때
- 업타임, 지연응답, 규모, 속도, 개인정보 보호 만족 + 비용 목표 만족 + 시점 기반 복구 => 망상

<br/>




