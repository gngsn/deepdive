# 자연어 기반 GraphRAG로 만드는 데이터 분석의 혁신

GraphRAG: 지식 그래프를 사용하여 RAG 앱에 더 관련성 높은 응답 생성

**Graph Database**
- 그래프 데이터베이스는 관련된 값을 찾는 것을 도움
- 복잡한 관계를 원하는 정보를 쉽게 찾게 도와줌

- 관계를 저장하고 탐색하기 위해 설계된 데이터베이스
- Node는 실제 개체(Entity)를 나타냄
- Edge는 개체 간 관계 `{key: value}`
- Node와 Edge의 속성은 Property로 저장됨

#### 활용 사례
- 부정 거래 탐지 (Fraud detection)
- 디지털 트윈
- 지식 체계화 (knowledge graph): 지식 효율적이고 체계적으로 관리. 가령, 논문 간 연관성

=> Amazon Neptune Database

#### Neptune Notebooks

- Jupyter Notebooks
- 사용자 정의 "매직"명령어
- 오픈소스 프로젝트
- 다양한 그래프 데이터베이스 지원

#### Graph Explorer

Notebook 이스턴스에 내장
분석가를 위한 도구 (쿼리 작성 불필요)

오픈 소스로 제공 중: github.com/aws/graph-explorer

### 복잡한 데이터의 챌린지

- **연결성**: 여러 곳에 분산된 문서 내 데이터는 검색하기 어려움
- **특수성**: 임베딩은 데이터의 희소 표현으로, 중요한 세부 정보가 부족할 수 있음
- **설명 가능성**: 검색된 데이터의 관련성을 설명하는 것은 까다로움

여기서 잠깐, **가장 관련성있는 정보**가 **의미상 가장 가까운 것이 아닐 수 있음**

- **벡터 공간**은 수학적 근접겅으로 유사성을 비교함
  - => 언어적으로 유사성을 찾는데 탁월
  - e.g. 비교 가능한 **문장**의 비교
- **그래프 공간**에서는 관련성을 공유된 연결을 비교함
  - => 실제적 연결이나 관련된 개념을 찾는데 탁월
  - e.g. 비교 가능한 **개념**의 비교

#### Vector Rag

1. 데이터 소스 > 적재 > 분할 > 임베딩 계산 (-> 파운데이션 모델)
2. **벡터 저장소**에 저장
3. 벡터 유사도 검색 --생성--> [프롬프트(지시사항/질문/컨텍스트) -> 파운데이터 모델]-> 응답 -> 질문 -...(반복)...-> 벡터 유사도 검색 --생성--> 프롬프트


#### GraphRag: 벡터와 그래프 결합

1. 데이터 소스 > 적재 > 분할 > 구축/유지 (임베딩 / 개체 및 사실 추출 / 개체 해결 (동의어) /링크 추출 / 제보 및 출처 / 보가 / 맥락적 클러스터링 ) (-> 파운데이션 모델)
2. **벡터 저장소**와 **그래프**
3. 검색 (진입점 찾기/질문 관련 서브그래프 검색/컨텍스트 구성) ---생성---> [프롬프트(지시사항/질문/컨텍스트) -> 파운데이터 모델]-> 응답 -> 질문 -...(반복)...-> 벡터 유사도 검색 --생성--> 프롬프트


#### 데이터 기반 그래프 생성

Document > Chunks... > Entity0, Entity1, Entity2, ... (여러 Chunk가 Entity로 생성됨) > Fact0 (여러 Entity가 연결됨) 

- 그래프를 활용해 여러 문서의 관련 정보를 연결
- 벡터 검색만으로 찾기 어려운 청크까지 식별
- 더 정확하고 포괄적인 검색 가능

**검색 프로세스**
1. Entity0 에 대한 벡터 검색이 포함된 질문은 응답 생성을 위해 하나의 청크를 찾음
2. Entity0 에 대한 벡터 검색과 그래프 순회를 결합하면, 응답 생성을 위해 세 개의 청크를 검색 (Entity0이 연결된 Fact0에서, 또 연결된 Entity3, Entity9 까지 확인)


- 그래프와 벡터 검색의 결합은 더 정확하고 포괄적인 응답을 생성할 수 있음
- 특히 multi-document, multi-hop 질문에서 더욱 효과적



#### GraphRAG Toolkit

- Python Tool-kit
  - Github에서 사용 가능
  - LlamaIndex 컴포넌트 사용
  - .. ?

https://github.com/awslabs/graphrag-toolkit












